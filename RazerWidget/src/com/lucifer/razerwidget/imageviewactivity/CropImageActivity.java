package com.lucifer.razerwidget.imageviewactivity;import com.lucifer.razerlib.imageview.cropimage.CropImageView;import com.lucifer.razerlib.utils.ImageUtils;import com.lucifer.razerwidget.R;import android.app.Activity;import android.graphics.Bitmap;import android.graphics.Matrix;import android.graphics.drawable.BitmapDrawable;import android.graphics.drawable.Drawable;import android.os.Bundle;import android.view.View;import android.view.View.OnClickListener;import android.widget.Button;import android.widget.ImageView;import android.widget.RelativeLayout;public class CropImageActivity extends Activity{	private Button btn_crop;	private ImageView img_crop;		CropImageView cropImg;		RelativeLayout rl_buttons;	Button btn_save;	Button btn_xuanzhuan;		Drawable drawable;	private Bitmap bitmap = null;	private int degrees = 90;	private int drawWidth = 350, drawHeight = 350;		@Override	protected void onCreate(Bundle savedInstanceState)	{		// TODO Auto-generated method stub		super.onCreate(savedInstanceState);				setContentView(R.layout.aty_cropimage);				btn_crop = (Button) findViewById(R.id.btn_crop);		img_crop = (ImageView) findViewById(R.id.img_crop);				cropImg = (CropImageView) findViewById(R.id.cropImg);				rl_buttons = (RelativeLayout) findViewById(R.id.rl_buttons);		btn_save = (Button) findViewById(R.id.btn_save);		btn_xuanzhuan = (Button) findViewById(R.id.btn_xuanzhuan);						btn_crop.setOnClickListener(new OnClickListener()		{			@Override			public void onClick(View v)			{				// TODO Auto-generated method stub				btn_crop.setVisibility(View.GONE);				img_crop.setVisibility(View.GONE);				cropImg.setVisibility(View.VISIBLE);				rl_buttons.setVisibility(View.VISIBLE);								drawable = getResources().getDrawable(R.drawable.image);				cropImg.setDrawable(drawable, 200, 200);							}		});						btn_save.setOnClickListener(new OnClickListener()		{			@Override			public void onClick(View v)			{				// TODO Auto-generated method stub				Bitmap cropBitmap = cropImg.getCropImage();				cropImg.setVisibility(View.GONE);				rl_buttons.setVisibility(View.GONE);				btn_crop.setVisibility(View.VISIBLE);				img_crop.setVisibility(View.VISIBLE);								img_crop.setImageBitmap(cropBitmap);							}		});						btn_xuanzhuan.setOnClickListener(new OnClickListener()		{			@Override			public void onClick(View v)			{				// TODO Auto-generated method stub				bitmap = ImageUtils.drawableToBitmapByBD(drawable);				Matrix matrix = new Matrix();				matrix.setRotate(degrees);				bitmap = Bitmap.createBitmap(bitmap, 0, 0, bitmap.getWidth(),						bitmap.getHeight(), matrix, true);				cropImg.setDrawable(new BitmapDrawable(getResources(),						bitmap), drawWidth, drawWidth);				degrees = degrees + 90;			}		});			}		}